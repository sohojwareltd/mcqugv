import{r as s,j as e,a as m,H as M}from"./app-ZXoLAm10.js";import{c as N,B as x,C as j}from"./Card-BszGGNYH.js";import{I as H}from"./Input-DMTpNqze.js";import{C as I,M as u}from"./CountdownTimer-qNUPLlq8.js";import{a as _}from"./api-XClNs4ak.js";import{S as A}from"./sparkles-DaHCZ3HG.js";import{A as g}from"./arrow-left-Dye33PDe.js";import{T as B}from"./trophy-aLZPs-xs.js";/* empty css            */import"./compiler-runtime-BMS3uoPX.js";const D=N("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const E=N("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function K({examId:h}){const[n,b]=s.useState(null),[y,f]=s.useState(!0),[v,o]=s.useState(""),[l,w]=s.useState(""),[r,k]=s.useState(null),[S,i]=s.useState(!1);s.useEffect(()=>{c()},[h]),s.useEffect(()=>{if(r){const t=()=>{new Date>=r&&(i(!0),c())};t();const a=setInterval(t,1e3);return()=>clearInterval(a)}},[r]);const c=async()=>{try{f(!0);const t=h||1,a=await _.get(`/exams/${t}/leaderboard`);b(a.data),o(""),i(!0)}catch(t){t.response?.status===403?(o(t.response.data.error),t.response.data.publish_at&&(k(new Date(t.response.data.publish_at)),i(!1))):o(t.response?.data?.error||"Failed to load leaderboard")}finally{f(!1)}},L=t=>t===1?e.jsx(u,{className:"w-6 h-6 text-yellow-500"}):t===2?e.jsx(u,{className:"w-6 h-6 text-gray-400"}):t===3?e.jsx(u,{className:"w-6 h-6 text-amber-600"}):e.jsx("span",{className:"w-6 h-6 flex items-center justify-center text-muted-foreground font-bold",children:t}),C=t=>{const a=new Date(t),p=a.getHours(),T=a.getMinutes();return`${p.toString().padStart(2,"0")}:${T.toString().padStart(2,"0")}`};if(y)return e.jsx("div",{className:"min-h-screen gradient-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading leaderboard..."})]})});if(!S&&r)return e.jsx("div",{className:"min-h-screen gradient-bg flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full mb-6",children:[e.jsx(A,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-semibold text-primary",children:"MeritSpark"})]}),e.jsx("div",{className:"w-24 h-24 bg-secondary rounded-full flex items-center justify-center mx-auto mb-8 animate-float",children:e.jsx(D,{className:"w-12 h-12 text-muted-foreground"})}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Merit List Locked"}),e.jsxs("p",{className:"text-muted-foreground mb-8",children:["The merit list will be unlocked at"," ",e.jsx("span",{className:"font-semibold text-foreground",children:r.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx(I,{targetDate:r,onComplete:()=>{i(!0),c()}})}),e.jsxs(x,{variant:"outline",onClick:()=>m.visit("/"),children:[e.jsx(g,{className:"mr-2 w-4 h-4"}),"Back to Home"]})]})});if(!n||!n.participants.length)return e.jsx("div",{className:"min-h-screen gradient-bg flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:v||"No participants found"}),e.jsx(x,{onClick:()=>m.visit("/"),children:"Go Home"})]})});const d=n.participants.filter(t=>t.full_name.toLowerCase().includes(l.toLowerCase())||t.phone.includes(l));return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Merit List - MeritSpark"}),e.jsxs("div",{className:"min-h-screen gradient-bg",children:[e.jsx("div",{className:"bg-primary text-primary-foreground py-12",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary-foreground/10 px-4 py-2 rounded-full mb-4",children:[e.jsx(B,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Merit List 2024"})]}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Congratulations to All Participants!"}),e.jsxs("p",{className:"text-primary-foreground/80",children:["Total Participants: ",n.participants.length]})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(E,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(H,{placeholder:"Search by name or phone...",value:l,onChange:t=>w(t.target.value),className:"pl-12 h-12"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Showing ",d.length," of ",n.participants.length," results"]}),e.jsx("div",{className:"space-y-3",children:d.length===0?e.jsx(j,{className:"p-8 text-center card-shadow border-0",children:e.jsxs("p",{className:"text-muted-foreground",children:['No results found for "',l,'"']})}):d.map(t=>e.jsx(j,{className:`p-4 card-shadow border-0 transition-all hover:scale-[1.01] ${t.rank<=3?"ring-2 ring-primary/20":""}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-secondary flex items-center justify-center",children:L(t.rank)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:t.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:t.phone})]}),e.jsxs("div",{className:"flex-shrink-0 text-right",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:t.score}),e.jsx("div",{className:"text-xs text-muted-foreground",children:C(t.completed_at)})]})]})},t.rank))}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs(x,{variant:"outline",onClick:()=>m.visit("/"),children:[e.jsx(g,{className:"mr-2 w-4 h-4"}),"Back to Home"]})})]})]})]})}export{K as default};
